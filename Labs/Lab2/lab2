import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

csv_path = "Labs/Lab2/dataset.csv"

# Load the dataset (low_memory=False prevents dtype guessing warnings)
print("Loading the dataset... this may take a minute.")
df = pd.read_csv(csv_path, low_memory=False)

print(f"Dataset loaded successfully! Shape: {df.shape[0]:,} rows Ã— {df.shape[1]} columns")
df.head(20)


## EDA ##
print("Dataset structure overview:\n")
df.info()

print("\nList of columns:")
print(", ".join(df.columns))

# 1. Distribution of attack classes
plt.figure(figsize=(10,5))
sns.countplot(data=df, x="Class", hue="Class", order=df["Class"].value_counts().index, palette="tab10")
plt.title("Distribution of attack classes")
plt.xticks(rotation=45, ha='right')
plt.ylabel("Number of flows")
plt.xlabel("Class")
plt.show()

# 2. Distribution of Label (top 15)
top_labels = df["Label"].value_counts().head(15).reset_index()
top_labels.columns = ["Label", "Count"]

plt.figure(figsize=(10,5))
sns.barplot(data=top_labels, x="Label", y="Count", hue="Label", legend=False, palette="tab20")
plt.title("Top 15 attack labels")
plt.xticks(rotation=75, ha='right')
plt.ylabel("Number of flows")
plt.xlabel("Label")
plt.show()
